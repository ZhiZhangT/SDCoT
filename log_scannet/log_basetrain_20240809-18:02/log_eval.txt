CUDA_VISIBLE_DEVICES=0 python main/eval.py --phase test --method basetrain --dataset scannet --num_point 40000 --model_checkpoint_path log_scannet/log_basetrain_20240809-18:02 --n_novel_class 18 --cluster_sampling vote_fps --use_3d_nms --use_cls_nms --per_class_proposal
------------ Options -------------
ap_iou_threshold: 0.25
batch_size: 8
bn_decay_rate: 0.5
bn_decay_step: 20
cluster_sampling: vote_fps
conf_thresh: 0.05
consistency_ramp_len: 30
consistency_weight: 10.0
dataset: scannet
distillation_ramp_len: 30
distillation_weight: 1.0
ema_decay: 0.999
faster_eval: False
ft_layers: all
log_dir: /home/peisheng/SDCoT/log_scannet/log_basetrain_20240809-18:02
lr: 0.001
lr_decay_rate: 0.1
lr_decay_steps: [80, 120]
method: basetrain
model_checkpoint_path: log_scannet/log_basetrain_20240809-18:02
model_name: None
n_epochs: 150
n_novel_class: 18
nms_iou: 0.25
no_height: False
num_input_channel: 1
num_point: 40000
num_target: 128
pc_augm: False
per_class_proposal: True
phase: test
pseudo_cls_conf_thresh: 0.9
pseudo_obj_conf_thresh: 0.95
use_3d_nms: True
use_cls_nms: True
use_color: False
use_old_type_nms: False
vote_factor: 1
-------------- End ----------------

VALIDATION_DATA_PATH: /home/peisheng/SDCoT/scannet/scannet_val_detection_data
Testing classes: ['bathtub', 'bed', 'bookshelf', 'cabinet', 'chair', 'counter', 'curtain', 'desk', 'door', 'otherfurniture', 'picture', 'refrigerator', 'showercurtain', 'sink', 'sofa', 'table', 'toilet', 'window'] | number of scenes: 312
['scene0011_00', 'scene0011_01', 'scene0015_00', 'scene0019_00', 'scene0019_01', 'scene0025_00', 'scene0025_01', 'scene0025_02', 'scene0030_00', 'scene0030_01', 'scene0030_02', 'scene0046_00', 'scene0046_01', 'scene0046_02', 'scene0050_00', 'scene0050_01', 'scene0050_02', 'scene0063_00', 'scene0064_00', 'scene0064_01', 'scene0077_00', 'scene0077_01', 'scene0081_00', 'scene0081_01', 'scene0081_02', 'scene0084_00', 'scene0084_01', 'scene0084_02', 'scene0086_00', 'scene0086_01', 'scene0086_02', 'scene0088_00', 'scene0088_01', 'scene0088_02', 'scene0088_03', 'scene0095_00', 'scene0095_01', 'scene0100_00', 'scene0100_01', 'scene0100_02', 'scene0131_00', 'scene0131_01', 'scene0131_02', 'scene0139_00', 'scene0144_00', 'scene0144_01', 'scene0146_00', 'scene0146_01', 'scene0146_02', 'scene0149_00', 'scene0153_00', 'scene0153_01', 'scene0164_00', 'scene0164_01', 'scene0164_02', 'scene0164_03', 'scene0169_00', 'scene0169_01', 'scene0187_00', 'scene0187_01', 'scene0193_00', 'scene0193_01', 'scene0196_00', 'scene0203_00', 'scene0203_01', 'scene0203_02', 'scene0207_00', 'scene0207_01', 'scene0207_02', 'scene0208_00', 'scene0217_00', 'scene0221_00', 'scene0221_01', 'scene0222_00', 'scene0222_01', 'scene0231_00', 'scene0231_01', 'scene0231_02', 'scene0246_00', 'scene0249_00', 'scene0251_00', 'scene0256_00', 'scene0256_01', 'scene0256_02', 'scene0257_00', 'scene0277_00', 'scene0277_01', 'scene0277_02', 'scene0278_00', 'scene0278_01', 'scene0300_00', 'scene0300_01', 'scene0304_00', 'scene0307_00', 'scene0307_01', 'scene0307_02', 'scene0314_00', 'scene0316_00', 'scene0328_00', 'scene0329_00', 'scene0329_01', 'scene0329_02', 'scene0334_00', 'scene0334_01', 'scene0334_02', 'scene0338_00', 'scene0338_01', 'scene0338_02', 'scene0342_00', 'scene0343_00', 'scene0351_00', 'scene0351_01', 'scene0353_00', 'scene0353_01', 'scene0353_02', 'scene0354_00', 'scene0355_00', 'scene0355_01', 'scene0356_00', 'scene0356_01', 'scene0356_02', 'scene0357_00', 'scene0357_01', 'scene0377_00', 'scene0377_01', 'scene0377_02', 'scene0378_00', 'scene0378_01', 'scene0378_02', 'scene0382_00', 'scene0382_01', 'scene0389_00', 'scene0406_00', 'scene0406_01', 'scene0406_02', 'scene0412_00', 'scene0412_01', 'scene0414_00', 'scene0423_00', 'scene0423_01', 'scene0423_02', 'scene0426_00', 'scene0426_01', 'scene0426_02', 'scene0426_03', 'scene0427_00', 'scene0430_00', 'scene0430_01', 'scene0432_00', 'scene0432_01', 'scene0435_00', 'scene0435_01', 'scene0435_02', 'scene0435_03', 'scene0441_00', 'scene0458_00', 'scene0458_01', 'scene0461_00', 'scene0462_00', 'scene0474_00', 'scene0474_01', 'scene0474_02', 'scene0474_03', 'scene0474_04', 'scene0474_05', 'scene0488_00', 'scene0488_01', 'scene0490_00', 'scene0494_00', 'scene0496_00', 'scene0500_00', 'scene0500_01', 'scene0518_00', 'scene0527_00', 'scene0535_00', 'scene0549_00', 'scene0549_01', 'scene0550_00', 'scene0552_00', 'scene0552_01', 'scene0553_00', 'scene0553_01', 'scene0553_02', 'scene0558_00', 'scene0558_01', 'scene0558_02', 'scene0559_00', 'scene0559_01', 'scene0559_02', 'scene0565_00', 'scene0568_00', 'scene0568_01', 'scene0568_02', 'scene0574_00', 'scene0574_01', 'scene0574_02', 'scene0575_00', 'scene0575_01', 'scene0575_02', 'scene0578_00', 'scene0578_01', 'scene0578_02', 'scene0580_00', 'scene0580_01', 'scene0583_00', 'scene0583_01', 'scene0583_02', 'scene0591_00', 'scene0591_01', 'scene0591_02', 'scene0593_00', 'scene0593_01', 'scene0595_00', 'scene0598_00', 'scene0598_01', 'scene0598_02', 'scene0599_00', 'scene0599_01', 'scene0599_02', 'scene0606_00', 'scene0606_01', 'scene0606_02', 'scene0607_00', 'scene0607_01', 'scene0608_00', 'scene0608_01', 'scene0608_02', 'scene0609_00', 'scene0609_01', 'scene0609_02', 'scene0609_03', 'scene0616_00', 'scene0616_01', 'scene0618_00', 'scene0621_00', 'scene0629_00', 'scene0629_01', 'scene0629_02', 'scene0633_00', 'scene0633_01', 'scene0643_00', 'scene0644_00', 'scene0645_00', 'scene0645_01', 'scene0645_02', 'scene0647_00', 'scene0647_01', 'scene0648_00', 'scene0648_01', 'scene0651_00', 'scene0651_01', 'scene0651_02', 'scene0652_00', 'scene0653_00', 'scene0653_01', 'scene0655_00', 'scene0655_01', 'scene0655_02', 'scene0658_00', 'scene0660_00', 'scene0663_00', 'scene0663_01', 'scene0663_02', 'scene0664_00', 'scene0664_01', 'scene0664_02', 'scene0665_00', 'scene0665_01', 'scene0670_00', 'scene0670_01', 'scene0671_00', 'scene0671_01', 'scene0678_00', 'scene0678_01', 'scene0678_02', 'scene0684_00', 'scene0684_01', 'scene0685_00', 'scene0685_01', 'scene0685_02', 'scene0686_00', 'scene0686_01', 'scene0686_02', 'scene0689_00', 'scene0690_00', 'scene0690_01', 'scene0693_00', 'scene0693_01', 'scene0693_02', 'scene0695_00', 'scene0695_01', 'scene0695_02', 'scene0695_03', 'scene0696_00', 'scene0696_01', 'scene0696_02', 'scene0697_00', 'scene0697_01', 'scene0697_02', 'scene0697_03', 'scene0699_00', 'scene0700_00', 'scene0700_01', 'scene0700_02', 'scene0701_00', 'scene0701_01', 'scene0701_02', 'scene0702_00', 'scene0702_01', 'scene0702_02', 'scene0704_00', 'scene0704_01']
Training classes: ['bathtub', 'bed', 'bookshelf', 'cabinet', 'chair', 'counter', 'curtain', 'desk', 'door', 'otherfurniture', 'picture', 'refrigerator', 'showercurtain', 'sink', 'sofa', 'table', 'toilet', 'window'] | number of scenes: 1199
Batch Size used:  8
------------ **BEFORE** Classifier Weights Learned:------------  
 tensor([[-0.1499, -0.1868, -0.0620,  ..., -0.1261, -0.0177,  0.0394],
        [ 0.1246,  0.0331,  0.1076,  ..., -0.0299, -0.0162, -0.0890],
        [-0.1065, -0.1425, -0.1273,  ...,  0.0320,  0.0973,  0.1889],
        ...,
        [ 0.1718, -0.0999,  0.0993,  ...,  0.0261,  0.2414,  0.2866],
        [-0.1269, -0.0711,  0.1518,  ..., -0.1038, -0.0565,  0.0088],
        [-0.0284,  0.0333,  0.0922,  ...,  0.0054,  0.1852, -0.1290]])
loaded /home/peisheng/SDCoT/log_scannet/log_basetrain_20240809-18:02/checkpoint.tar, epoch 150
2024-08-10 23:56:53.168606
------------ **AFTER** Classifier Weights Learned:------------  
 tensor([[ 0.2763,  0.0548, -0.5560,  ..., -0.1812, -0.0090,  0.0578],
        [-0.6124, -0.0539, -0.1264,  ..., -0.2245,  0.4958, -0.0716],
        [-0.0822, -0.0014, -0.2535,  ..., -0.0178, -0.3954, -0.4669],
        ...,
        [ 0.1366, -0.3021, -0.1712,  ...,  0.1664, -0.1181,  0.2477],
        [-0.2960, -0.3480, -0.2461,  ...,  0.0665, -0.1452, -0.6168],
        [ 0.4388,  0.1133,  0.1823,  ...,  0.1525,  0.1921, -0.0366]],
       device='cuda:0')
Eval batch: 0
eval mean box_loss: 0.123015
eval mean center_loss: 0.052054
eval mean detection_loss: 0.289824
eval mean heading_cls_loss: 0.000000
eval mean heading_reg_loss: 0.000000
eval mean neg_ratio: 0.528320
eval mean obj_acc: 0.877186
eval mean objectness_loss: 0.102210
eval mean pos_ratio: 0.157577
eval mean sem_cls_loss: 0.578523
eval mean size_reg_loss: 0.070960
eval mean supervised_loss: 6.965492
eval mean vote_loss: 0.406725
0 0.7440351312627317
1 0.8769340557823958
2 0.4508991385391611
3 0.40001207965236685
4 0.8547290014680943
5 0.5311665771159578
6 0.44668057569858427
7 0.697811583777762
8 0.4073504085077793
9 0.3910127001856674
10 0.05036104139047411
11 0.45393143490786486
12 0.5694107288758276
13 0.541719039502694
14 0.8734383577647906
15 0.5791263507473137
16 0.9529576743167735
17 0.32881891881081315
eval bathtub Average Precision: 0.744035
eval bed Average Precision: 0.876934
eval bookshelf Average Precision: 0.450899
eval cabinet Average Precision: 0.400012
eval chair Average Precision: 0.854729
eval counter Average Precision: 0.531167
eval curtain Average Precision: 0.446681
eval desk Average Precision: 0.697812
eval door Average Precision: 0.407350
eval otherfurniture Average Precision: 0.391013
eval picture Average Precision: 0.050361
eval refrigerator Average Precision: 0.453931
eval showercurtain Average Precision: 0.569411
eval sink Average Precision: 0.541719
eval sofa Average Precision: 0.873438
eval table Average Precision: 0.579126
eval toilet Average Precision: 0.952958
eval window Average Precision: 0.328819
eval mAP: 0.563911
eval bathtub Recall: 0.935484
eval bed Recall: 0.962963
eval bookshelf Recall: 0.870130
eval cabinet Recall: 0.744624
eval chair Recall: 0.896199
eval counter Recall: 0.807692
eval curtain Recall: 0.761194
eval desk Recall: 0.944882
eval door Recall: 0.702355
eval otherfurniture Recall: 0.694340
eval picture Recall: 0.171171
eval refrigerator Recall: 0.877193
eval showercurtain Recall: 0.964286
eval sink Recall: 0.704082
eval sofa Recall: 0.958763
eval table Recall: 0.814286
eval toilet Recall: 1.000000
eval window Recall: 0.613475
eval AR: 0.801284
------------ Ground Truths Dataframe: ------------: 
